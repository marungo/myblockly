<html>
<head>
	<title>Testing Tables</title>
	<!-- <link rel="stylesheet" type="text/css" href="styles.css" /> -->
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="styles.css" />
	<script src="javascript.js"></script>
	<script src="blocks.js"></script>
	<script src="blockly/blockly_uncompressed.js"></script>
	<script src="blockly/blockly_compressed.js"></script>
    <script src="blockly/generators/javascript.js"></script>
    <script src="blockly/msg/js/en.js"></script>
    <script src="blocks.js"></script>
</head>
<body>
	<h1 id="header">Testing Table Talk</h1>
	
	<!-- TABLE WHERE CANVAS AND BLOCKLY INJECTION COMMUNICATE-->
	<table width="100%" height="400px">
		<tr>
			<td id="broadcast" width="50%">
				<div id="blockly" style="height:90%"></div>
				<button onclick="draw()">Press Me</button></td>
			<td id="receive">
				<canvas id="myCanvas" style="border:1px solid #000000;" width="500px" height="350px">
			</td>
		</tr>
	</table>

	<!-- TOOLBOX -->
	<xml id="toolbox" style="display: none">
      <category name="Colors">
        <block type='color_yellow'></block>
      </category>
      <category name="Movement">
        <block type="move"></block>
        <block type="turn"></block>
      </category>
      <category name="Math">
        <block type="number"></block>
      </category>
    </xml>

	<script>
		var ctx;
		function draw() {
			var c = document.getElementById("myCanvas");
			ctx = c.getContext("2d");
			// console.log(ctx);
			ctx.moveTo(0,0);
			ctx.beginPath();
			ctx.arc(50,50,40,0,2*Math.PI);
			ctx.stroke();
		}

		var blocklyArea = document.getElementById("blockly");
		var workspace = Blockly.inject(blocklyArea,
	      {toolbox: document.getElementById('toolbox')});
	</script>

	<script>
		window.blockly_loaded = function(blockly) {
			return window.Blockly = blockly;
		}
		window.run_code = function() {
			code = window.Blockly.JavaScript.workspaceToCode();
			eval(code);
		}
	</script>
</body>
</html>
